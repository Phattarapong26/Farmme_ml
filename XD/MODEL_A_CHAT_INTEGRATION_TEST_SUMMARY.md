# ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Model A Wrapper ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Chat

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏î‡∏™‡∏≠‡∏ö:** 23 ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2568  
**‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö:** Kiro AI Assistant  
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

---

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á **Model A (Crop Recommendation)** ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Chat ‡∏ú‡πà‡∏≤‡∏ô Gemini Function Calling ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ Model A ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô Chat Interface ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

## ‚úÖ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### Step 1: Model A Wrapper
- ‚úÖ **Import ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à**
- ‚úÖ **Model ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à** (Mock Model ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö)
- ‚úÖ **Model Path:** `REMEDIATION_PRODUCTION/trained_models/model_a_xgboost.pkl`
- ‚úÖ **Features:** 19 features (Gradient Boosting model)

### Step 2: Recommendation Model Service
- ‚úÖ **Import ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à**
- ‚úÖ **‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Model A Wrapper ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à**
- ‚úÖ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö `get_recommendations()` ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à**
  - Input: ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà, ‡∏î‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏ô, ‡∏ô‡πâ‡∏≥‡∏ù‡∏ô, ‡∏á‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á, ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥
  - Output: 10 ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏û‡∏∑‡∏ä
  - Top 3: ‡∏ú‡∏±‡∏Å‡πÇ‡∏Ç‡∏°, ‡∏ú‡∏±‡∏Å‡∏ä‡∏µ, ‡∏ï‡πâ‡∏ô‡∏´‡∏≠‡∏°

### Step 3: Gemini Function Handler
- ‚úÖ **Import ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à**
- ‚úÖ **‡∏û‡∏ö Function:** `get_crop_recommendations`
- ‚úÖ **Function Description:** ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£
- ‚úÖ **Required Parameters:** `['province']`
- ‚úÖ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö `execute_function()` ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à**
  - Input: ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤, ‡∏î‡∏¥‡∏ô‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß, ‡∏ä‡∏•‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô, ‡∏á‡∏ö‡∏™‡∏π‡∏á, ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á
  - Output: 10 ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏û‡∏∑‡∏ä
  - Top 3: ‡∏Ñ‡∏∞‡∏ô‡πâ‡∏≤ (ROI 300%), ‡∏Å‡∏ß‡∏≤‡∏á‡∏ï‡∏∏‡πâ‡∏á (ROI 300%), ‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á (ROI 300%)

### Step 4: Integration Flow (End-to-End)

#### Test 1: ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£)
- ‚úÖ **Success**
- Model Used: `ml_model_with_filtering (model_a_xgboost.pkl)`
- Recommendations: 10 ‡∏û‡∏∑‡∏ä
- Top Crop: ‡∏Ñ‡∏∞‡∏ô‡πâ‡∏≤ (Score: 1.00)

#### Test 2: ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç (‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ)
- ‚úÖ **Success**
- Input: ‡∏î‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏ô‡∏õ‡∏ô‡∏ó‡∏£‡∏≤‡∏¢, ‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•, ‡∏á‡∏ö‡∏ï‡πà‡∏≥, ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á
- Model Used: `ml_model_with_filtering (model_a_xgboost.pkl)`
- Recommendations: 10 ‡∏û‡∏∑‡∏ä
- Top Crop: ‡∏Ñ‡∏∞‡∏ô‡πâ‡∏≤ (Score: 1.00)

#### Test 3: ‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ (‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢)
- ‚úÖ **Success**
- Input: ‡∏î‡∏¥‡∏ô‡∏ó‡∏£‡∏≤‡∏¢, ‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥/‡∏Ñ‡∏•‡∏≠‡∏á
- Model Used: `ml_model_with_filtering (model_a_xgboost.pkl)`
- Recommendations: 10 ‡∏û‡∏∑‡∏ä
- Top Crop: ‡∏Ñ‡∏∞‡∏ô‡πâ‡∏≤ (Score: 1.00)

---

## üîÑ ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠

```
User Query (Chat)
    ‚Üì
Gemini AI (Function Calling)
    ‚Üì
gemini_functions.py
    ‚îú‚îÄ function_handler.execute_function("get_crop_recommendations", args)
    ‚Üì
recommendation_model_service.py
    ‚îú‚îÄ recommendation_model_service.get_recommendations(...)
    ‚Üì
model_a_wrapper.py
    ‚îú‚îÄ model_a_wrapper.get_recommendations(...)
    ‚îú‚îÄ model_a_wrapper._ml_recommendations_with_filtering(...)
    ‚Üì
Model A (Gradient Boosting)
    ‚îú‚îÄ model.predict(features)
    ‚Üì
Return Recommendations
    ‚Üì
Gemini AI (Format Response)
    ‚Üì
User (Chat Response)
```

---

## üìä ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

### Model A Wrapper
- ‚úÖ ‡πÇ‡∏´‡∏•‡∏î Model (Gradient Boosting, 19 features)
- ‚úÖ ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ ROI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏û‡∏∑‡∏ä
- ‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏î‡∏¥‡∏ô (fuzzy matching)
- ‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏ï‡∏≤‡∏°‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ô‡πâ‡∏≥
- ‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏ï‡∏≤‡∏°‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
- ‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
- ‚úÖ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Suitability Score
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (yield, revenue, growth days, water requirement, risk level, etc.)

### Recommendation Model Service
- ‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Model A Wrapper
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Fallback (rule-based) ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Model ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°
- ‚úÖ ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà Gemini ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ

### Gemini Function Handler
- ‚úÖ ‡∏£‡∏±‡∏ö Function Call ‡∏à‡∏≤‡∏Å Gemini
- ‚úÖ Validate Arguments
- ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Recommendation Service
- ‚úÖ ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á Gemini

---

## üéØ ‡∏™‡∏£‡∏∏‡∏õ

**Model A Wrapper ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Chat ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!**

‚úÖ ‡∏ó‡∏∏‡∏Å Component ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ  
‚úÖ ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Layer ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á  
‚úÖ Model A ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ú‡πà‡∏≤‡∏ô Gemini Function Calling  
‚úÖ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô  

---

## üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

1. **Mock Model:** ‡πÉ‡∏ä‡πâ Mock Model ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Model ‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å commit ‡πÉ‡∏ô Git (‡πÑ‡∏ü‡∏•‡πå .pkl ‡∏ñ‡∏π‡∏Å ignore)
2. **Production Model:** ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ Model ‡∏ó‡∏µ‡πà train ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å `REMEDIATION_PRODUCTION/modelA19_11_25/`
3. **Model Version:** Mock Model ‡∏à‡∏≥‡∏•‡∏≠‡∏á Gradient Boosting model ‡∏ó‡∏µ‡πà‡∏°‡∏µ 19 features (‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Model ‡∏à‡∏£‡∏¥‡∏á)

---

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ

1. ‚úÖ Model A ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Chat
2. ‚è≠Ô∏è ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ö Gemini API ‡∏à‡∏£‡∏¥‡∏á (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ API Key)
3. ‚è≠Ô∏è ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ö User Profile ‡πÅ‡∏•‡∏∞ Conversation History
4. ‚è≠Ô∏è Deploy Model ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏ó‡∏ô Mock Model

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢:** Kiro AI Assistant  
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 23 ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2568
